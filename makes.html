<!DOCTYPE html>
<html lang="en"><head>
  <script src="./js/jquery.min.js"></script>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,viewport-fit=cover">
  <title>Used Cars by Make - Carslyst</title>
  <link rel="preload" href="./css/style.css" as="style">
  <link rel="stylesheet" href="./css/style.css">
  <script src="./js/utlParam.js"></script>
<body>
<header id="header">
</header>

<main style="height: auto !important;">
  <div class="main" style="height: auto !important;">
    <div class="container detail">
      <h1>Used Cars by Make</h1>
    </div>
    <div class="bottom" style="height: auto !important;">
      <div class="container" style="height: auto !important;">
        <div class="general-wrap">
          <h2>Browse by Make</h2>
          <ul class="general-list brand-list order">

            <li class="general-item">
              <a href="/car-makes/Toyota/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/toyota.png" alt="Toyota">
              </div>
              <a href="/car-makes/Toyota/" class="brand-name">Toyota</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Honda/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/honda.png" alt="Honda">
              </div>
              <a href="/car-makes/Honda/" class="brand-name">Honda</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Nissan/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/nissan.png" alt="Nissan">
              </div>
              <a href="/car-makes/Nissan/" class="brand-name">Nissan</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Hyundai/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/hyundai.png" alt="Hyundai">
              </div>
              <a href="/car-makes/Hyundai/" class="brand-name">Hyundai</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Ford/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/ford.png" alt="Ford">
              </div>
              <a href="/car-makes/Ford/" class="brand-name">Ford</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Chevrolet/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/chevrolet.png" alt="Chevrolet">
              </div>
              <a href="/car-makes/Chevrolet/" class="brand-name">Chevrolet</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Jeep/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/jeep.png" alt="Jeep">
              </div>
              <a href="/car-makes/Jeep/" class="brand-name">Jeep</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/BMW/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/bmw.png" alt="BMW">
              </div>
              <a href="/car-makes/BMW/" class="brand-name">BMW</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Mercedes-Benz/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/mercedes-benz.png" alt="Mercedes-Benz">
              </div>
              <a href="/car-makes/Mercedes-Benz/" class="brand-name">Mercedes-Benz</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Kia/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/kia.png" alt="Kia">
              </div>
              <a href="/car-makes/Kia/" class="brand-name">Kia</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Volkswagen/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/volkswagen.png" alt="Volkswagen">
              </div>
              <a href="/car-makes/Volkswagen/" class="brand-name">Volkswagen</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/GMC/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/gmc.png" alt="GMC">
              </div>
              <a href="/car-makes/GMC/" class="brand-name">GMC</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Dodge/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/dodge.png" alt="Dodge">
              </div>
              <a href="/car-makes/Dodge/" class="brand-name">Dodge</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Subaru/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/subaru.png" alt="Subaru">
              </div>
              <a href="/car-makes/Subaru/" class="brand-name">Subaru</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Lexus/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/lexus.png" alt="Lexus">
              </div>
              <a href="/car-makes/Lexus/" class="brand-name">Lexus</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Mazda/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/mazda.png" alt="Mazda">
              </div>
              <a href="/car-makes/Mazda/" class="brand-name">Mazda</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/RAM/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/ram.png" alt="RAM">
              </div>
              <a href="/car-makes/RAM/" class="brand-name">RAM</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Tesla/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/tesla.png" alt="Tesla">
              </div>
              <a href="/car-makes/Tesla/" class="brand-name">Tesla</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Audi/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/audi.png" alt="Audi">
              </div>
              <a href="/car-makes/Audi/" class="brand-name">Audi</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Cadillac/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/cadillac.png" alt="Cadillac">
              </div>
              <a href="/car-makes/Cadillac/" class="brand-name">Cadillac</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Buick/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/buick.png" alt="Buick">
              </div>
              <a href="/car-makes/Buick/" class="brand-name">Buick</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Acura/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/acura.png" alt="Acura">
              </div>
              <a href="/car-makes/Acura/" class="brand-name">Acura</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Chrysler/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/chrysler.png" alt="Chrysler">
              </div>
              <a href="/car-makes/Chrysler/" class="brand-name">Chrysler</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Volvo/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/volvo.png" alt="Volvo">
              </div>
              <a href="/car-makes/Volvo/" class="brand-name">Volvo</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Lincoln/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/lincoln.png" alt="Lincoln">
              </div>
              <a href="/car-makes/Lincoln/" class="brand-name">Lincoln</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Mitsubishi/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/mitsubishi.png" alt="Mitsubishi">
              </div>
              <a href="/car-makes/Mitsubishi/" class="brand-name">Mitsubishi</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Infiniti/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/infiniti.png" alt="Infiniti">
              </div>
              <a href="/car-makes/Infiniti/" class="brand-name">Infiniti</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Land-Rover/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/land-rover.png" alt="Land Rover">
              </div>
              <a href="/car-makes/Land-Rover/" class="brand-name">Land Rover</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Porsche/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/porsche.png" alt="Porsche">
              </div>
              <a href="/car-makes/Porsche/" class="brand-name">Porsche</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Jaguar/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/jaguar.png" alt="Jaguar">
              </div>
              <a href="/car-makes/Jaguar/" class="brand-name">Jaguar</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Mini/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/mini.png" alt="Mini">
              </div>
              <a href="/car-makes/Mini/" class="brand-name">Mini</a>
            </li>

            <li class="general-item">
              <a href="/car-makes/Pontiac/" class="link-cover"></a>
              <div class="brand-pic">
                <img src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/pontiac.png" alt="Pontiac">
              </div>
              <a href="/car-makes/Pontiac/" class="brand-name">Pontiac</a>
            </li>

          </ul>

        </div>
      </div>
      <div class="aside">
        <div class="aside-type">
          <h2>Browse by Type</h2>
          <ul class="aside-type-list number">

          </ul>
        </div>
      </div>
    </div>
  </div>
</main>

<footer  id="footer">
</footer>

<script>
  // 加载 header
  fetch('./header.html')
          .then(res => res.text())
          .then(data => {
            document.getElementById('header').innerHTML = data;

            $(".icon-nav").click(function() {
              $(".nav-cover").toggleClass('expand');
              $(".header-nav").toggleClass('expand');
            })
            $(".nav-cover").click(function() {
              $(".nav-cover").toggleClass('expand');
              $(".header-nav").toggleClass('expand');
            })

            $(".nav-item.expand .nav-con").on('click', function(e) {
              if ($(e.target).closest('.icon-go').length) {
                e.preventDefault();
                $(this).parent().find(".nav-sub-list").toggleClass("expand");
              }
            });
          });

  // 加载 footer
  fetch('./footer.html')
          .then(res => res.text())
          .then(data => {
            document.getElementById('footer').innerHTML = data;
          });
</script>

<script type="module">
  import { fetchAllCategoriesWithCount } from './js/supabaseApi.js';

  function formatNumber(num) {
    return Number(num).toLocaleString("en-US");
  }

  async function renderAllCategories() {

    const { data, error } =
            await fetchAllCategoriesWithCount();

    if (error || !data) {
      console.error(error);
      return;
    }

    const ul = document.querySelector(
            ".aside-type-list.number"
    );

    ul.innerHTML = "";

    data.forEach(item => {

      const name = item.category;
      //const slug = item.category_slug;
      const image = item.category_img;
      const count = item.count;

      let next_url = `./states.html?category=${name}`

      const li = document.createElement("li");

      li.className = "aside-type-item";

      li.innerHTML = `
      <a href="${next_url}"
         class="link-cover"></a>

      <img class="aside-type-icon"
           src="https://pub-683228af40b042bb882e1ed4bda118b8.r2.dev/images/${image}"
           alt="${name}">

      <span>
        <a href="${next_url}"
           class="aside-type-name">
           ${name} for Sale
        </a>

        <span class="aside-type-count general-num">
          ${formatNumber(count)}
        </span>
      </span>
    `;

      ul.appendChild(li);

    });
  }

  document.querySelectorAll('a.link-cover, a.brand-name').forEach(el => {
    // 从 brand-name 获取 make，或者从 href 提取
    let make = el.textContent.trim();

    // 如果 link-cover 没有文本，从 href 提取
    if (!make) {
      const match = el.getAttribute('href').match(/\/car-makes\/([^\/]+)\//);
      if (match) {
        make = match[1];
      }
    }

    if (make) {
      el.href = `./states.html?make=${encodeURIComponent(make)}`;
    }
  });


  document.addEventListener(
          "DOMContentLoaded",
          renderAllCategories
  );
</script>

</body>
</html>